import{r as p,a as T,w as E,o as a,c as r,b as s,u as n,d as F,F as i,e as d,f as C,v as I,g as R,W as U,n as u,t as b}from"./index-22529255.js";import{f as S,S as k}from"./fetchData-0e835b49.js";const q={id:"TransPage",class:"py-3 sm:px-12 sm:py-7 container border border-none"},z={class:"grid grid-cols-9 gap-3 mx-auto text-center mb-4 sm:mb-8"},W=s("i",{"data-feather":"chevron-left"},null,-1),G=[W],H={class:"col-span-7 sm:col-span-3"},J=s("div",{class:"col-span-1 sm:col-span-3 mx-auto"},[s("i",{"data-feather":"chevron-right"})],-1),K={class:"grid grid-cols-1 gap-x-12 gap-y-6 sm:grid-cols-2"},Q=s("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"類別",-1),X={class:"shadow-sm rounded-md border dark:border-none w-full"},Y={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},Z=["onClick"],tt=s("label",{for:"Detail",class:"font-semibold mb-2 text-left block dark:text-white"},"明細",-1),et=s("label",{for:"Amount",class:"font-semibold mb-2 text-left block dark:text-white"},"轉帳金額",-1),st={key:0,class:"text-right text-red-300"},ot=s("div",{class:"sm:col-span-2"},[s("hr")],-1),lt={class:""},nt=s("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"轉出帳戶",-1),at={class:"shadow-sm rounded-md border dark:border-none w-full"},rt={class:"grid grid-cols-2 sm:grid-cols-4 SelTransOutAcc bg-teal-400"},ct=["onMouseover"],it={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},dt=["onClick"],ut={class:"TransIn"},bt=s("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"轉入帳戶",-1),mt={class:"shadow-sm rounded-md border dark:border-none w-full"},ft={class:"grid grid-cols-2 sm:grid-cols-4 SelTransInAcc bg-teal-400"},gt=["onMouseover"],pt={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},kt=["onClick"],ht={class:""},xt=s("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"經手",-1),_t={class:"shadow-sm rounded-md border dark:border-none w-full"},vt={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},yt=["onClick"],wt={class:"mt-10 mx-auto grid grid-cols-2 gap-3 sm:block"},Tt={__name:"TransferPage",setup(At,{emit:h}){(async()=>{try{h("loading",!0);const o=await S("get","Trans");o.status===200?(x.push(...o.data[0].TransCategories),m.push(...o.data[1].PayAccounts),f.push(...o.data[1].PayAccounts),y.push(...o.data[2].PayMents),_.value=Object.values(m[0])[0],v.value=Object.values(f[0])[0],e.OutAccount=Object.keys(m[0])[0],e.InAccount=Object.keys(f[0])[0],e.Cg=x[0]):k.fire({title:"oops!",text:o.data,icon:"info"})}catch(o){k.fire({title:"ERROR",text:o.message,icon:"error"}),console.error(o)}h("loading",!1)})();const x=p([]),m=p([]),f=p([]),y=p([]);let _=T(""),v=T(""),e=p({Type:"轉帳",OutAccount:"",OutAcc:"",InAccount:"",InAcc:"",Cg:"",Date:new Date,Amount:"",Detail:"",Transment:""});const j=o=>{_.value=Object.values(o)[0],e.OutAccount=Object.keys(o)[0]},M=o=>{v.value=Object.values(o)[0],e.InAccount=Object.keys(o)[0]},$=o=>{w(m,e.OutAccount,".SelTransOutAcc"),e.OutAcc=o},V=o=>{w(f,e.InAccount,".SelTransInAcc"),e.InAcc=o},w=(o,l,t)=>{const c=o.find(g=>g[l]),B=Object.keys(c)[0],O=Array.from(document.querySelectorAll(t+" li"));O.forEach(g=>g.classList.remove("bg-teal-100"));const D=O.find(g=>g.innerText.includes(B));D.classList.remove("bg-teal-400"),D.classList.add("bg-teal-100")},A=()=>{for(const o in e)e[o]="";e.Type="轉帳",e.Date=new Date},L=o=>{for(const t of Object.keys(e))if((t==="Cg"||t==="Amount")&&!e[t]&&o.Trans!==""){k.fire({title:"資料未輸入完整!",icon:"warning"});return}const l=new FormData;for(const t in o)l.append(t,o[t]);P(l)};async function P(o){h("loading",!0);try{const l=await S("post","",o);l.data.status==="success"?(k.fire({title:"記帳成功!",icon:l.data.status}),A()):console.log(l),console.log("response",l)}catch(l){k.fire({title:"失敗!",text:l.message,icon:"error"}),console.error(l)}h("loading",!1)}const N=o=>{const l=o===""?0:o;return!/^\d+$/.test(l)};return E(()=>e.Amount,o=>{}),(o,l)=>(a(),r("div",q,[s("div",z,[s("div",{class:"col-span-1 sm:col-span-3 mx-auto",onClick:l[0]||(l[0]=(...t)=>n(e).Date&&n(e).Date(...t))},G),s("div",H,[F(n(U),{modelValue:n(e).Date,"onUpdate:modelValue":l[1]||(l[1]=t=>n(e).Date=t),"enable-time-picker":!1,locale:"zh-tw","six-weeks":"center",required:"","text-input":"","auto-apply":"",dark:""},null,8,["modelValue"])]),J]),s("div",K,[s("div",null,[Q,s("div",X,[s("ul",Y,[(a(!0),r(i,null,d(x,t=>(a(),r("li",{key:o.ment,class:u({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(e).Cg===t,"dark:text-white":n(e).Cg!==t}),onClick:c=>n(e).Cg=t},b(t),11,Z))),128))])])]),s("div",null,[tt,C(s("input",{type:"text",id:"Detail","onUpdate:modelValue":l[2]||(l[2]=t=>n(e).Detail=t),class:"shadow-sm rounded-md border dark:border-none px-1 py-1 w-full text-left bg-slate-100 dark:text-white dark:bg-neutral-700"},null,512),[[I,n(e).Detail]])]),s("div",null,[et,C(s("input",{type:"text",id:"Amount","onUpdate:modelValue":l[3]||(l[3]=t=>n(e).Amount=t),class:"px-1 py-1 w-full text-left outline-none font-bold bg-slate-100 dark:text-white dark:bg-neutral-700 shadow-sm rounded-md"},null,512),[[I,n(e).Amount]]),N(n(e).Amount)?(a(),r("h5",st,"* 只能輸入數字")):R("",!0)]),ot,s("div",lt,[nt,s("div",at,[s("ul",rt,[(a(!0),r(i,null,d(m,t=>(a(),r("li",{key:t,class:u({"px-1 py-1":!0,"bg-white":n(e).OutAccount===t}),onMouseover:c=>j(t)},b(Object.keys(t)[0]),43,ct))),128))]),s("ul",it,[(a(!0),r(i,null,d(n(_),t=>(a(),r("li",{key:t,class:u({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(e).OutAcc===t,"dark:text-white":n(e).OutAcc!==t}),onClick:c=>$(t)},b(t),11,dt))),128))])])]),s("div",ut,[bt,s("div",mt,[s("ul",ft,[(a(!0),r(i,null,d(f,t=>(a(),r("li",{key:t,class:u({"px-1 py-1":!0,"bg-white":n(e).InAccount===t}),onMouseover:c=>M(t)},b(Object.keys(t)[0]),43,gt))),128))]),s("ul",pt,[(a(!0),r(i,null,d(n(v),t=>(a(),r("li",{key:t,class:u({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(e).InAcc===t,"dark:text-white":n(e).InAcc!==t}),onClick:c=>V(t)},b(t),11,kt))),128))])])]),s("div",ht,[xt,s("div",_t,[s("ul",vt,[(a(!0),r(i,null,d(y,t=>(a(),r("li",{key:t,class:u({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(e).Transment===t,"dark:text-white":n(e).Transment!==t}),onClick:c=>n(e).Transment=t},b(t),11,yt))),128))])])])]),s("div",wt,[s("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600 sm:mr-5",onClick:l[4]||(l[4]=t=>L(n(e)))},"送出"),s("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 fous-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[5]||(l[5]=t=>A())},"清除")])]))}};export{Tt as default};
