import{r as k,a as C,o as B,w as U,b as a,c as r,d as o,e as q,u as n,F as b,f as m,g as I,v as S,h as z,W,n as g,t as f}from"./index-7668bbec.js";import{s as G,f as j,S as h,u as H,a as J}from"./fetchData-9f3fb34f.js";const K={id:"TransPage",class:"py-3 sm:px-16 sm:py-6 container border border-none"},Q={class:"grid grid-cols-1 gap-x-12 gap-y-6 sm:grid-cols-2"},X={class:"grid grid-cols-4 sm:grid-cols-5 gap-3 mx-auto sm:mt-9 w-full"},Y={class:"col-span-3 sm:col-span-3"},Z={class:"col-span-1 sm:col-span-none"},ee=o("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"類別",-1),te={class:"shadow-sm rounded-md border dark:border-none w-full"},se={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},oe=["onClick"],le=o("label",{for:"Detail",class:"font-semibold mb-2 text-left block dark:text-white"},"明細",-1),ne=o("label",{for:"Amount",class:"font-semibold mb-2 text-left block dark:text-white"},"轉帳金額",-1),ae={key:0,class:"text-right text-red-300"},re=o("div",{class:"sm:col-span-2"},[o("hr")],-1),ce={class:""},ie=o("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"轉出帳戶",-1),de={class:"shadow-sm rounded-md border dark:border-none w-full"},ue={class:"grid grid-cols-2 sm:grid-cols-4 SelTransOutAcc bg-teal-400"},be=["onMouseover"],me={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},ge=["onClick"],fe={class:"TransIn"},pe=o("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"轉入帳戶",-1),ke={class:"shadow-sm rounded-md border dark:border-none w-full"},he={class:"grid grid-cols-2 sm:grid-cols-4 SelTransInAcc bg-teal-400"},xe=["onMouseover"],_e={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},ve=["onClick"],ye={class:""},we=o("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"經手",-1),Ae={class:"shadow-sm rounded-md border dark:border-none w-full"},Oe={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},Te=["onClick"],De={class:"mt-10 mx-auto grid grid-cols-2 gap-3 sm:block"},je={__name:"TransferPage",setup(Ce,{emit:i}){const _=t=>{x.push(...t[0].TransCategories),d.push(...t[1].PayAccounts),u.push(...t[1].PayAccounts),v.push(...t[2].PayMents),y.value=Object.values(d[0])[0],w.value=Object.values(u[0])[0],s.OutAccount=Object.keys(d[0])[0],s.InAccount=Object.keys(u[0])[0],s.Cg=x[0]};(async()=>{try{i("loading",!0),G("Trans")||await j("get","Trans",_)}catch(t){h.fire({title:"ERROR",text:t.message,icon:"error"}),console.error(t)}i("loading",!1)})();const x=k([]),d=k([]),u=k([]),v=k([]);let y=C(""),w=C(""),s=k({Type:"轉帳",OutAccount:"",OutAcc:"",InAccount:"",InAcc:"",Cg:"",Date:new Date,Amount:"",Detail:"",Transment:""});B(async()=>{await H("Trans",_)});const M=async()=>{try{i("loading",!0),[x,d,u,v].forEach(t=>t.splice(0,t.length)),localStorage.removeItem("Trans"),await j("get","Trans",_)}catch(t){h.fire({title:"ERROR",text:t.message,icon:"error"}),console.error(t)}i("loading",!1)},$=t=>{y.value=Object.values(t)[0],s.OutAccount=Object.keys(t)[0]},V=t=>{w.value=Object.values(t)[0],s.InAccount=Object.keys(t)[0]},L=t=>{A(d,s.OutAccount,".SelTransOutAcc"),s.OutAcc=t},P=t=>{A(u,s.InAccount,".SelTransInAcc"),s.InAcc=t},A=(t,l,e)=>{const c=t.find(p=>p[l]),N=Object.keys(c)[0],T=Array.from(document.querySelectorAll(e+" li"));T.forEach(p=>p.classList.remove("bg-teal-100"));const D=T.find(p=>p.innerText.includes(N));D.classList.remove("bg-teal-400"),D.classList.add("bg-teal-100")},O=()=>{for(const t in s)s[t]="";s.Type="轉帳",s.Date=new Date},R=t=>{for(const e of Object.keys(s))if((e==="Cg"||e==="Amount")&&!s[e]&&t.Trans!==""){h.fire({title:"資料未輸入完整!",icon:"warning"});return}const l=new FormData;for(const e in t)l.append(e,t[e]);E(l)};async function E(t){i("loading",!0);try{const l=await J("post","",t);l.data.status==="success"?(h.fire({title:"記帳成功!",icon:l.data.status}),O()):console.log(l),console.log("response",l)}catch(l){h.fire({title:"失敗!",text:l.message,icon:"error"}),console.error(l)}i("loading",!1)}const F=t=>{const l=t===""?0:t;return!/^\d+$/.test(l)};return U(()=>s.Amount,t=>{}),(t,l)=>(a(),r("div",K,[o("div",Q,[o("div",X,[o("div",Y,[q(n(W),{modelValue:n(s).Date,"onUpdate:modelValue":l[0]||(l[0]=e=>n(s).Date=e),"enable-time-picker":!1,locale:"zh-tw","six-weeks":"center",required:"","text-input":"","auto-apply":"",dark:"","week-start":"0"},null,8,["modelValue"])]),o("div",Z,[o("button",{class:"rounded-md bg-teal-600 px-3 sm:px-5 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[1]||(l[1]=e=>M())},"重整")])]),o("div",null,[ee,o("div",te,[o("ul",se,[(a(!0),r(b,null,m(x,e=>(a(),r("li",{key:t.ment,class:g({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(s).Cg===e,"dark:text-white":n(s).Cg!==e}),onClick:c=>n(s).Cg=e},f(e),11,oe))),128))])])]),o("div",null,[le,I(o("input",{type:"text",id:"Detail","onUpdate:modelValue":l[2]||(l[2]=e=>n(s).Detail=e),class:"shadow-sm rounded-md border dark:border-none px-1 py-1 w-full text-left bg-slate-100 dark:text-white dark:bg-neutral-700"},null,512),[[S,n(s).Detail]])]),o("div",null,[ne,I(o("input",{type:"text",id:"Amount","onUpdate:modelValue":l[3]||(l[3]=e=>n(s).Amount=e),class:"px-1 py-1 w-full text-left outline-none font-bold bg-slate-100 dark:text-white dark:bg-neutral-700 shadow-sm rounded-md"},null,512),[[S,n(s).Amount]]),F(n(s).Amount)?(a(),r("h5",ae,"* 只能輸入數字")):z("",!0)]),re,o("div",ce,[ie,o("div",de,[o("ul",ue,[(a(!0),r(b,null,m(d,e=>(a(),r("li",{key:e,class:g({"px-1 py-1":!0,"bg-white":n(s).OutAccount===e}),onMouseover:c=>$(e)},f(Object.keys(e)[0]),43,be))),128))]),o("ul",me,[(a(!0),r(b,null,m(n(y),e=>(a(),r("li",{key:e,class:g({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(s).OutAcc===e,"dark:text-white":n(s).OutAcc!==e}),onClick:c=>L(e)},f(e),11,ge))),128))])])]),o("div",fe,[pe,o("div",ke,[o("ul",he,[(a(!0),r(b,null,m(u,e=>(a(),r("li",{key:e,class:g({"px-1 py-1":!0,"bg-white":n(s).InAccount===e}),onMouseover:c=>V(e)},f(Object.keys(e)[0]),43,xe))),128))]),o("ul",_e,[(a(!0),r(b,null,m(n(w),e=>(a(),r("li",{key:e,class:g({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(s).InAcc===e,"dark:text-white":n(s).InAcc!==e}),onClick:c=>P(e)},f(e),11,ve))),128))])])]),o("div",ye,[we,o("div",Ae,[o("ul",Oe,[(a(!0),r(b,null,m(v,e=>(a(),r("li",{key:e,class:g({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(s).Transment===e,"dark:text-white":n(s).Transment!==e}),onClick:c=>n(s).Transment=e},f(e),11,Te))),128))])])])]),o("div",De,[o("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600 sm:mr-5",onClick:l[4]||(l[4]=e=>R(n(s)))},"送出"),o("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 fous-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[5]||(l[5]=e=>O())},"清除")])]))}};export{je as default};
