import{r as k,a as P,o as z,w as W,b as G,c as r,d as i,e as s,f as d,u as a,g,F as p,h,i as A,v as M,j as H,k as J,W as K,n as v,t as y,l as Q}from"./index-3aa2d797.js";import{s as X,f as $,S as _,u as Y,a as Z,C as L,N as ee,A as te}from"./dataValidation-29207d58.js";const se={id:"PayPage",class:"py-3 sm:px-12 sm:py-7 container border border-none"},oe={class:"grid grid-cols-1 gap-x-12 gap-y-6 sm:grid-cols-2"},le={class:"grid grid-cols-4 sm:grid-cols-5 gap-3 mx-auto sm:mt-9 w-full"},ae={class:"col-span-3 sm:col-span-3"},ne={class:"col-span-1 sm:col-span-none"},re={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},ie={class:"shadow-sm rounded-md border dark:border-none w-full"},ce={class:"grid grid-cols-4 sm:grid-cols-8 SelPayCg bg-teal-400"},de=["onMouseover"],ue={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelCg"},me=["onClick"],be={for:"Detail",class:"font-semibold mb-2 text-left block dark:text-white"},fe={for:"Amount",class:"font-semibold mb-2 text-left block dark:text-white"},ge={key:0,class:"text-right text-red-300"},pe=s("div",{class:"sm:col-span-2"},[s("hr")],-1),he={class:""},ye={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},xe={class:"shadow-sm rounded-md border dark:border-none w-full"},ke={class:"grid grid-cols-2 sm:grid-cols-4 SelPayAcc bg-teal-400"},ve=["onMouseover"],_e={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},we=["onClick"],Pe={class:""},Ae={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},Oe={class:"shadow-sm rounded-md border dark:border-none w-full"},Ce={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},Se=["onClick"],De={class:"sm:col-span-2"},je={for:"Other",class:"font-semibold mb-2 text-left block dark:text-white"},Me={class:"grid grid-cols-2 sm:grid-cols-6 bg-slate-100 dark:bg-neutral-700 shadow-sm rounded-md"},Ve=["id","value"],Ne=["for"],Re={class:"flex w-full col-span-2 px-1 py-1"},$e=s("input",{type:"checkbox",name:"其他",id:"其他"},null,-1),Le=s("label",{class:"dark:text-white",for:"其他"},"其他",-1),Ee={class:"mt-10 mx-auto grid grid-cols-2 gap-3 sm:block"},Te={__name:"PayPage",setup(Ue,{emit:u}){const O=t=>{m.push(...t[0].PayCategories),b.push(...t[1].PayAccounts),C.push(...t[2].PayMents),S.push(...t[3].PayOthers),D.value=Object.values(m[0])[0],j.value=Object.values(b[0])[0],o.Account=Object.keys(b[0])[0],o.Category=Object.keys(m[0])[0]};(async()=>{try{u("loading",!0),X("Pay")||await $("get","Pay",O)}catch(t){_.fire({title:"ERROR",text:t.message,icon:"error"}),console.error(t)}u("loading",!1)})();const m=k([]),b=k([]),C=k([]),S=k([]);let D=P(""),j=P(""),f=P(""),V=P(!1),o=k({Type:"支出",Account:"",Acc:"",Category:"",Cg:"",Date:new Date,Amount:"",Detail:"",Payment:"",Other:[]});z(()=>{Y("Pay",O)});const E=async()=>{try{u("loading",!0),[m,b,C,S].forEach(t=>t.splice(0,t.length)),localStorage.removeItem("Pay"),await $("get","Pay",O)}catch(t){_.fire({title:"ERROR",text:t.message,icon:"error"}),console.error(t)}u("loading",!1)},U=t=>{D.value=Object.values(t)[0],o.Category=Object.keys(t)[0]},F=t=>{j.value=Object.values(t)[0],o.Account=Object.keys(t)[0]},I=t=>{N(m,o.Category,".SelPayCg"),o.Cg=t},T=t=>{N(b,o.Account,".SelPayAcc"),o.Acc=t},N=(t,l,n)=>{const e=t.find(x=>x[l]),c=Object.keys(e)[0],w=Array.from(document.querySelectorAll(n+" li"));w.forEach(x=>x.classList.remove("bg-teal-100"));const R=w.find(x=>x.innerText.includes(c));R.classList.remove("bg-teal-400"),R.classList.add("bg-teal-100")},q=t=>{f.value.length!==0&&o.Other.push(f.value),t.Other=t.Other.join(", ");for(const n of Object.keys(o))if(n!=="Payment"&&n!=="Other"&&!o[n]&&t.Pay!==""){_.fire({title:"資料未輸入完整!",icon:"warning"});return}const l=new FormData;for(const n in t)l.append(n,t[n]);B(l)};async function B(t){u("loading",!0);try{const l=await Z("post","",t);l.data.status==="success"?(_.fire({title:"記帳成功!",icon:l.data.status}),L(o,"支出")):console.log(l),console.log("response")}catch(l){_.fire({title:"失敗!",text:l.message,icon:"error"}),console.error(l)}u("loading",!1)}return W(()=>o.Amount,t=>{t=t.replaceAll(",",""),o.Amount=ee(t),V.value=te(t)}),(t,l)=>{const n=G("font-awesome-icon");return r(),i("div",se,[s("div",oe,[s("div",le,[s("div",ae,[d(a(K),{modelValue:a(o).Date,"onUpdate:modelValue":l[0]||(l[0]=e=>a(o).Date=e),"enable-time-picker":!1,locale:"zh-tw","six-weeks":"center",required:"","text-input":"","auto-apply":"",dark:"","week-start":"0"},null,8,["modelValue"])]),s("div",ne,[s("button",{class:"rounded-md bg-teal-600 px-3 sm:px-5 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[1]||(l[1]=e=>E())},"重整")])]),s("div",null,[s("label",re,[d(n,{icon:["fas","chart-pie"]}),g(" 類別")]),s("div",ie,[s("ul",ce,[(r(!0),i(p,null,h(m,e=>(r(),i("li",{key:e,class:v({"px-1 py-1":!0,"bg-white":a(o).Category===e}),onMouseover:c=>U(e)},y(Object.keys(e)[0]),43,de))),128))]),s("ul",ue,[(r(!0),i(p,null,h(a(D),e=>(r(),i("li",{key:e,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":a(o).Cg===e,"dark:text-white":a(o).Cg!==e}),onClick:c=>I(e)},y(e),11,me))),128))])])]),s("div",null,[s("label",be,[d(n,{icon:["fas","align-left"]}),g(" 明細")]),A(s("input",{type:"text",id:"Detail","onUpdate:modelValue":l[2]||(l[2]=e=>a(o).Detail=e),class:"shadow-sm rounded-md border dark:border-none px-1 py-1 w-full text-left bg-slate-100 dark:text-white dark:bg-neutral-700"},null,512),[[M,a(o).Detail]])]),s("div",null,[s("label",fe,[d(n,{icon:["fas","dollar-sign"]}),g(" 金額")]),A(s("input",{type:"text",id:"Amount","onUpdate:modelValue":l[3]||(l[3]=e=>a(o).Amount=e),class:"px-1 py-1 w-full text-left outline-none font-bold bg-slate-100 dark:text-white dark:bg-neutral-700 shadow-sm rounded-md"},null,512),[[M,a(o).Amount]]),a(V)?(r(),i("h5",ge,"* 只能輸入數字")):H("",!0)]),pe,s("div",he,[s("label",ye,[d(n,{icon:["fas","wallet"]}),g(" 帳戶")]),s("div",xe,[s("ul",ke,[(r(!0),i(p,null,h(b,e=>(r(),i("li",{key:e,class:v({"px-1 py-1":!0,"bg-white":a(o).Account===e}),onMouseover:c=>F(e)},y(Object.keys(e)[0]),43,ve))),128))]),s("ul",_e,[(r(!0),i(p,null,h(a(j),e=>(r(),i("li",{key:e,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":a(o).Acc===e,"dark:text-white":a(o).Acc!==e}),onClick:c=>T(e)},y(e),11,we))),128))])])]),s("div",Pe,[s("label",Ae,[d(n,{icon:["fas","money-bill-transfer"]}),g(" 經手")]),s("div",Oe,[s("ul",Ce,[(r(!0),i(p,null,h(C,e=>(r(),i("li",{key:e,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":a(o).Payment===e,"dark:text-white":a(o).Payment!==e}),onClick:c=>a(o).Payment=e},y(e),11,Se))),128))])])]),s("div",De,[s("label",je,[d(n,{icon:["fas","pen-to-square"]}),g(" 備註")]),s("div",Me,[(r(!0),i(p,null,h(S,(e,c)=>(r(),i("div",{key:e,class:"px-1 py-1 text-left"},[A(s("input",{type:"checkbox",id:"PayOthers"+c,"onUpdate:modelValue":l[4]||(l[4]=w=>a(o).Other=w),value:e},null,8,Ve),[[Q,a(o).Other]]),s("label",{class:"dark:text-white cursor-pointer",for:"PayOthers"+c},y(e),9,Ne)]))),128)),s("div",Re,[$e,Le,A(s("input",{type:"text",class:"dark:text-white bg-transparent","onUpdate:modelValue":l[5]||(l[5]=e=>J(f)?f.value=e:f=e)},null,512),[[M,a(f)]])])])])]),s("div",Ee,[s("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600 sm:mr-5",onClick:l[6]||(l[6]=e=>q(a(o)))},"送出"),s("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 fous-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[7]||(l[7]=e=>a(L)(a(o),"支出"))},"清除")])])}}};export{Te as default};
