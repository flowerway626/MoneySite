import{r as b,a as j,o as F,w as N,b as a,c as r,d as t,e as T,u as n,F as f,f as p,g as k,v as A,h as B,i as q,W as z,n as v,t as h,j as W}from"./index-7668bbec.js";import{s as G,f as M,S as g,u as H,a as J}from"./fetchData-9f3fb34f.js";const K={id:"IncomePage",class:"py-3 sm:px-12 sm:py-7 container border border-none"},Q={class:"grid grid-cols-1 gap-x-12 gap-y-6 sm:grid-cols-2"},X={class:"grid grid-cols-4 sm:grid-cols-5 gap-3 mx-auto sm:mt-9 w-full"},Y={class:"col-span-3 sm:col-span-3"},Z={class:"col-span-1 sm:col-span-none"},ee=t("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"類別",-1),te={class:"shadow-sm rounded-md border dark:border-none w-full"},se={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},oe=["onClick"],le=t("label",{for:"Detail",class:"font-semibold mb-2 text-left block dark:text-white"},"明細",-1),ne=t("label",{for:"Amount",class:"font-semibold mb-2 text-left block dark:text-white"},"金額",-1),ae={key:0,class:"text-right text-red-300"},re=t("div",{class:"sm:col-span-2"},[t("hr")],-1),ce={class:""},ie=t("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"帳戶",-1),de={class:"shadow-sm rounded-md border dark:border-none w-full"},ue={class:"grid grid-cols-2 sm:grid-cols-4 SelIncomeAcc bg-teal-400"},me=["onMouseover"],be={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},fe=["onClick"],pe={class:""},he=t("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"經手",-1),ge={class:"shadow-sm rounded-md border dark:border-none w-full"},xe={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},ke=["onClick"],ve={class:"sm:col-span-2"},_e=t("label",{for:"Other",class:"font-semibold mb-2 text-left block dark:text-white"},"備註",-1),we={class:"grid grid-cols-2 sm:grid-cols-6 bg-slate-100 dark:bg-neutral-700 shadow-sm rounded-md"},ye=["id","value"],Ie=["for"],Oe={class:"flex w-full col-span-2 px-1 py-1"},Ae=t("input",{type:"checkbox",name:"其他",id:"其他"},null,-1),De=t("label",{class:"dark:text-white",for:"其他"},"其他",-1),Ce={class:"mt-10 mx-auto grid grid-cols-2 gap-3 sm:block"},Ve={__name:"IncomePage",setup(Se,{emit:i}){const _=s=>{x.push(...s[0].IncomeCategories),d.push(...s[1].PayAccounts),w.push(...s[2].PayMents),y.push(...s[3].PayOthers),I.value=Object.values(d[0])[0],o.Account=Object.keys(d[0])[0],o.Cg=Object.keys(x)[0]};(async()=>{try{i("loading",!0),G("Income")||await M("get","Income",_)}catch(s){g.fire({title:"ERROR",text:s.message,icon:"error"}),console.error(s)}i("loading",!1)})();const x=b([]),d=b([]),w=b([]),y=b([]);let I=j(""),u=j(""),o=b({Type:"收入",Account:"",Acc:"",Cg:"",Date:new Date,Amount:"",Detail:"",Incomement:"",Other:[]});F(()=>{H("Income",_)});const V=async()=>{try{i("loading",!0),[x,d,w,y].forEach(s=>s.splice(0,s.length)),localStorage.removeItem("Income"),await M("get","Income",_)}catch(s){g.fire({title:"ERROR",text:s.message,icon:"error"}),console.error(s)}i("loading",!1)},P=s=>{I.value=Object.values(s)[0],o.Account=Object.keys(s)[0]},R=s=>{$(d,o.Account,".SelIncomeAcc"),o.Acc=s},$=(s,l,e)=>{const c=s.find(m=>m[l]),O=Object.keys(c)[0],C=Array.from(document.querySelectorAll(e+" li"));C.forEach(m=>m.classList.remove("bg-teal-100"));const S=C.find(m=>m.innerText.includes(O));S.classList.remove("bg-teal-400"),S.classList.add("bg-teal-100")},D=()=>{for(const s in o)s!=="Other"&&(o[s]="");o.Other=[],o.Type="收入",o.Date=new Date},L=s=>{u.value.length!==0&&o.Other.push(u.value),s.Other=s.Other.join(", ");for(const e of Object.keys(o))if(e!=="Incomement"&&e!=="Other"&&!o[e]&&s.Income!==""){g.fire({title:"資料未輸入完整!",icon:"warning"});return}const l=new FormData;for(const e in s)l.append(e,s[e]);E(l)};async function E(s){i("loading",!0);try{const l=await J("post","",s);l.data.status==="success"?(g.fire({title:"記帳成功!",icon:l.data.status}),D()):console.log(l),console.log("response")}catch(l){g.fire({title:"失敗!",text:l.message,icon:"error"}),console.error(l)}i("loading",!1)}const U=s=>{const l=s===""?0:s;return!/^\d+$/.test(l)};return N(()=>o.Amount,s=>{}),(s,l)=>(a(),r("div",K,[t("div",Q,[t("div",X,[t("div",Y,[T(n(z),{modelValue:n(o).Date,"onUpdate:modelValue":l[0]||(l[0]=e=>n(o).Date=e),"enable-time-picker":!1,locale:"zh-tw","six-weeks":"center",required:"","text-input":"","auto-apply":"",dark:"","week-start":"0"},null,8,["modelValue"])]),t("div",Z,[t("button",{class:"rounded-md bg-teal-600 px-3 sm:px-5 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[1]||(l[1]=e=>V())},"重整")])]),t("div",null,[ee,t("div",te,[t("ul",se,[(a(!0),r(f,null,p(x,e=>(a(),r("li",{key:s.ment,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(o).Cg===e,"dark:text-white":n(o).Cg!==e}),onClick:c=>n(o).Cg=e},h(e),11,oe))),128))])])]),t("div",null,[le,k(t("input",{type:"text",id:"Detail","onUpdate:modelValue":l[2]||(l[2]=e=>n(o).Detail=e),class:"shadow-sm rounded-md border dark:border-none px-1 py-1 w-full text-left bg-slate-100 dark:text-white dark:bg-neutral-700"},null,512),[[A,n(o).Detail]])]),t("div",null,[ne,k(t("input",{type:"text",id:"Amount","onUpdate:modelValue":l[3]||(l[3]=e=>n(o).Amount=e),class:"px-1 py-1 w-full text-left outline-none font-bold bg-slate-100 dark:text-white dark:bg-neutral-700 shadow-sm rounded-md"},null,512),[[A,n(o).Amount]]),U(n(o).Amount)?(a(),r("h5",ae,"* 只能輸入數字")):B("",!0)]),re,t("div",ce,[ie,t("div",de,[t("ul",ue,[(a(!0),r(f,null,p(d,e=>(a(),r("li",{key:e,class:v({"px-1 py-1":!0,"bg-white":n(o).Account===e}),onMouseover:c=>P(e)},h(Object.keys(e)[0]),43,me))),128))]),t("ul",be,[(a(!0),r(f,null,p(n(I),e=>(a(),r("li",{key:e,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(o).Acc===e,"dark:text-white":n(o).Acc!==e}),onClick:c=>R(e)},h(e),11,fe))),128))])])]),t("div",pe,[he,t("div",ge,[t("ul",xe,[(a(!0),r(f,null,p(w,e=>(a(),r("li",{key:e,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(o).Incomement===e,"dark:text-white":n(o).Incomement!==e}),onClick:c=>n(o).Incomement=e},h(e),11,ke))),128))])])]),t("div",ve,[_e,t("div",we,[(a(!0),r(f,null,p(y,(e,c)=>(a(),r("div",{key:e,class:"px-1 py-1 text-left"},[k(t("input",{type:"checkbox",id:"IncomeOthers"+c,"onUpdate:modelValue":l[4]||(l[4]=O=>n(o).Other=O),value:e},null,8,ye),[[W,n(o).Other]]),t("label",{class:"dark:text-white cursor-pointer",for:"IncomeOthers"+c},h(e),9,Ie)]))),128)),t("div",Oe,[Ae,De,k(t("input",{type:"text",class:"dark:text-white bg-transparent","onUpdate:modelValue":l[5]||(l[5]=e=>q(u)?u.value=e:u=e)},null,512),[[A,n(u)]])])])])]),t("div",Ce,[t("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600 sm:mr-5",onClick:l[6]||(l[6]=e=>L(n(o)))},"送出"),t("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 fous-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[7]||(l[7]=e=>D())},"清除")])]))}};export{Ve as default};
