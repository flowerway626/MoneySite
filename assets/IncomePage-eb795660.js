import{r as m,a as S,w as U,o as a,c as r,b as t,u as n,d as N,F as b,e as f,f as x,v as w,g as R,i as T,W as B,n as k,t as h,h as E}from"./index-36930423.js";import{f as F,S as p}from"./sweetalert2.all-ebbffb99.js";const q={id:"IncomePage",class:"py-3 sm:px-12 sm:py-7 container border border-none"},z={class:"grid grid-cols-9 gap-3 mx-auto text-center mb-4 sm:mb-8"},W=t("i",{"data-feather":"chevron-left"},null,-1),G=[W],H={class:"col-span-7 sm:col-span-3"},J=t("div",{class:"col-span-1 sm:col-span-3 mx-auto"},[t("i",{"data-feather":"chevron-right"})],-1),K={class:"grid grid-cols-1 gap-x-12 gap-y-6 sm:grid-cols-2"},Q=t("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"類別",-1),X={class:"shadow-sm rounded-md border dark:border-none w-full"},Y={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},Z=["onClick"],ee=t("label",{for:"Detail",class:"font-semibold mb-2 text-left block dark:text-white"},"明細",-1),te=t("label",{for:"Amount",class:"font-semibold mb-2 text-left block dark:text-white"},"金額",-1),se={key:0,class:"text-right text-red-300"},oe=t("div",{class:"sm:col-span-2"},[t("hr")],-1),le={class:""},ne=t("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"帳戶",-1),ae={class:"shadow-sm rounded-md border dark:border-none w-full"},re={class:"grid grid-cols-2 sm:grid-cols-4 SelIncomeAcc bg-teal-400"},ce=["onMouseover"],ie={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},de=["onClick"],ue={class:""},me=t("label",{for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},"經手",-1),be={class:"shadow-sm rounded-md border dark:border-none w-full"},fe={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},he=["onClick"],pe={class:"sm:col-span-2"},ge=t("label",{for:"Other",class:"font-semibold mb-2 text-left block dark:text-white"},"備註",-1),xe={class:"grid grid-cols-2 sm:grid-cols-6 bg-slate-100 dark:bg-neutral-700 shadow-sm rounded-md"},ke=["id","value"],_e=["for"],ve={class:"flex w-full col-span-2 px-1 py-1"},ye=t("input",{type:"checkbox",name:"其他",id:"其他"},null,-1),we=t("label",{class:"dark:text-white",for:"其他"},"其他",-1),Oe={class:"mt-10 mx-auto grid grid-cols-2 gap-3 sm:block"},Ce={__name:"IncomePage",setup(Ae,{emit:g}){(async()=>{try{g("loading",!0);const o=await F("get","Income");o.status===200?(_.push(...o.data[0].IncomeCategories),d.push(...o.data[1].PayAccounts),O.push(...o.data[2].PayMents),A.push(...o.data[3].PayOthers),v.value=Object.values(d[0])[0],s.Account=Object.keys(d[0])[0],s.Cg=Object.keys(_)[0]):p.fire({title:"oops!",text:o.data,icon:"info"})}catch(o){p.fire({title:"ERROR",text:o.message,icon:"error"}),console.error(o)}g("loading",!1)})();const _=m([]),d=m([]),O=m([]),A=m([]);let v=S(""),i=S(""),s=m({Type:"收入",Account:"",Acc:"",Cg:"",Date:new Date,Amount:"",Detail:"",Incomement:"",Other:[]});const V=o=>{v.value=Object.values(o)[0],s.Account=Object.keys(o)[0]},j=o=>{M(d,s.Account,".SelIncomeAcc"),s.Acc=o},M=(o,l,e)=>{const c=o.find(u=>u[l]),y=Object.keys(c)[0],I=Array.from(document.querySelectorAll(e+" li"));I.forEach(u=>u.classList.remove("bg-teal-100"));const C=I.find(u=>u.innerText.includes(y));C.classList.remove("bg-teal-400"),C.classList.add("bg-teal-100")},D=()=>{for(const o in s)o!=="Other"&&(s[o]="");s.Other=[],s.Type="收入",s.Date=new Date},P=o=>{i.value.length!==0&&s.Other.push(i.value),o.Other=o.Other.join(", ");for(const e of Object.keys(s))if(e!=="Incomement"&&e!=="Other"&&!s[e]&&o.Income!==""){p.fire({title:"資料未輸入完整!",icon:"warning"});return}const l=new FormData;for(const e in o)l.append(e,o[e]);L(l)};async function L(o){g("loading",!0);try{const l=await axios.fetchData("post","",o);l.data.status==="success"?(p.fire({title:"記帳成功!",icon:l.data.status}),D()):console.log(l),console.log("response")}catch(l){p.fire({title:"失敗!",text:l.message,icon:"error"}),console.error(l)}g("loading",!1)}const $=o=>{const l=o===""?0:o;return!/^\d+$/.test(l)};return U(()=>s.Amount,o=>{}),(o,l)=>(a(),r("div",q,[t("div",z,[t("div",{class:"col-span-1 sm:col-span-3 mx-auto",onClick:l[0]||(l[0]=(...e)=>n(s).Date&&n(s).Date(...e))},G),t("div",H,[N(n(B),{modelValue:n(s).Date,"onUpdate:modelValue":l[1]||(l[1]=e=>n(s).Date=e),"enable-time-picker":!1,locale:"zh-tw","six-weeks":"center",required:"","text-input":"","auto-apply":"",dark:""},null,8,["modelValue"])]),J]),t("div",K,[t("div",null,[Q,t("div",X,[t("ul",Y,[(a(!0),r(b,null,f(_,e=>(a(),r("li",{key:o.ment,class:k({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(s).Cg===e,"dark:text-white":n(s).Cg!==e}),onClick:c=>n(s).Cg=e},h(e),11,Z))),128))])])]),t("div",null,[ee,x(t("input",{type:"text",id:"Detail","onUpdate:modelValue":l[2]||(l[2]=e=>n(s).Detail=e),class:"shadow-sm rounded-md border dark:border-none px-1 py-1 w-full text-left bg-slate-100 dark:text-white dark:bg-neutral-700"},null,512),[[w,n(s).Detail]])]),t("div",null,[te,x(t("input",{type:"text",id:"Amount","onUpdate:modelValue":l[3]||(l[3]=e=>n(s).Amount=e),class:"px-1 py-1 w-full text-left outline-none font-bold bg-slate-100 dark:text-white dark:bg-neutral-700 shadow-sm rounded-md"},null,512),[[w,n(s).Amount]]),$(n(s).Amount)?(a(),r("h5",se,"* 只能輸入數字")):R("",!0)]),oe,t("div",le,[ne,t("div",ae,[t("ul",re,[(a(!0),r(b,null,f(d,e=>(a(),r("li",{key:e,class:k({"px-1 py-1":!0,"bg-white":n(s).Account===e}),onMouseover:c=>V(e)},h(Object.keys(e)[0]),43,ce))),128))]),t("ul",ie,[(a(!0),r(b,null,f(n(v),e=>(a(),r("li",{key:e,class:k({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(s).Acc===e,"dark:text-white":n(s).Acc!==e}),onClick:c=>j(e)},h(e),11,de))),128))])])]),t("div",ue,[me,t("div",be,[t("ul",fe,[(a(!0),r(b,null,f(O,e=>(a(),r("li",{key:e,class:k({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(s).Incomement===e,"dark:text-white":n(s).Incomement!==e}),onClick:c=>n(s).Incomement=e},h(e),11,he))),128))])])]),t("div",pe,[ge,t("div",xe,[(a(!0),r(b,null,f(A,(e,c)=>(a(),r("div",{key:e,class:"px-1 py-1 text-left"},[x(t("input",{type:"checkbox",id:"IncomeOthers"+c,"onUpdate:modelValue":l[4]||(l[4]=y=>n(s).Other=y),value:e},null,8,ke),[[E,n(s).Other]]),t("label",{class:"dark:text-white cursor-pointer",for:"IncomeOthers"+c},h(e),9,_e)]))),128)),t("div",ve,[ye,we,x(t("input",{type:"text",class:"dark:text-white bg-transparent","onUpdate:modelValue":l[5]||(l[5]=e=>T(i)?i.value=e:i=e)},null,512),[[w,n(i)]])])])])]),t("div",Oe,[t("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600 sm:mr-5",onClick:l[6]||(l[6]=e=>P(n(s)))},"送出"),t("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 fous-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[7]||(l[7]=e=>D())},"清除")])]))}};export{Ce as default};
