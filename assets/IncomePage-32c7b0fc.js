import{r as g,a as S,o as T,w as q,b as B,c as r,d as c,e as t,f as d,u as n,g as b,F as h,h as x,i as w,v as M,j as z,k as W,W as G,n as A,t as k,l as H}from"./index-3aa2d797.js";import{s as J,f as N,S as _,u as K,a as Q,C as P,N as X,A as Y}from"./dataValidation-29207d58.js";const Z={id:"IncomePage",class:"py-3 sm:px-12 sm:py-7 container border border-none"},ee={class:"grid grid-cols-1 gap-x-12 gap-y-6 sm:grid-cols-2"},te={class:"grid grid-cols-4 sm:grid-cols-5 gap-3 mx-auto sm:mt-9 w-full"},se={class:"col-span-3 sm:col-span-3"},oe={class:"col-span-1 sm:col-span-none"},le={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},ne={class:"shadow-sm rounded-md border dark:border-none w-full"},ae={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},re=["onClick"],ce={for:"Detail",class:"font-semibold mb-2 text-left block dark:text-white"},ie={for:"Amount",class:"font-semibold mb-2 text-left block dark:text-white"},de={key:0,class:"text-right text-red-300"},ue=t("div",{class:"sm:col-span-2"},[t("hr")],-1),me={class:""},fe={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},be={class:"shadow-sm rounded-md border dark:border-none w-full"},pe={class:"grid grid-cols-2 sm:grid-cols-4 SelIncomeAcc bg-teal-400"},ge=["onMouseover"],he={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},xe=["onClick"],ke={class:""},_e={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},ve={class:"shadow-sm rounded-md border dark:border-none w-full"},ye={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},we=["onClick"],Ae={class:"sm:col-span-2"},Ie={for:"Other",class:"font-semibold mb-2 text-left block dark:text-white"},Oe={class:"grid grid-cols-2 sm:grid-cols-6 bg-slate-100 dark:bg-neutral-700 shadow-sm rounded-md"},Ce=["id","value"],De=["for"],Se={class:"flex w-full col-span-2 px-1 py-1"},Me=t("input",{type:"checkbox",name:"其他",id:"其他"},null,-1),je=t("label",{class:"dark:text-white",for:"其他"},"其他",-1),Ve={class:"mt-10 mx-auto grid grid-cols-2 gap-3 sm:block"},Le={__name:"IncomePage",setup(Ne,{emit:u}){const I=s=>{v.push(...s[0].IncomeCategories),m.push(...s[1].PayAccounts),O.push(...s[2].PayMents),C.push(...s[3].PayOthers),D.value=Object.values(m[0])[0],o.Account=Object.keys(m[0])[0],o.Cg=Object.keys(v)[0]};(async()=>{try{u("loading",!0),J("Income")||await N("get","Income",I)}catch(s){_.fire({title:"ERROR",text:s.message,icon:"error"}),console.error(s)}u("loading",!1)})();const v=g([]),m=g([]),O=g([]),C=g([]);let D=S(""),f=S(""),j=S(!1),o=g({Type:"收入",Account:"",Acc:"",Cg:"",Date:new Date,Amount:"",Detail:"",Incomement:"",Other:[]});T(()=>{K("Income",I)});const R=async()=>{try{u("loading",!0),[v,m,O,C].forEach(s=>s.splice(0,s.length)),localStorage.removeItem("Income"),await N("get","Income",I)}catch(s){_.fire({title:"ERROR",text:s.message,icon:"error"}),console.error(s)}u("loading",!1)},L=s=>{D.value=Object.values(s)[0],o.Account=Object.keys(s)[0]},$=s=>{E(m,o.Account,".SelIncomeAcc"),o.Acc=s},E=(s,l,a)=>{const e=s.find(p=>p[l]),i=Object.keys(e)[0],y=Array.from(document.querySelectorAll(a+" li"));y.forEach(p=>p.classList.remove("bg-teal-100"));const V=y.find(p=>p.innerText.includes(i));V.classList.remove("bg-teal-400"),V.classList.add("bg-teal-100")},U=s=>{f.value.length!==0&&o.Other.push(f.value),s.Other=s.Other.join(", ");for(const a of Object.keys(o))if(a!=="Incomement"&&a!=="Other"&&!o[a]&&s.Income!==""){_.fire({title:"資料未輸入完整!",icon:"warning"});return}const l=new FormData;for(const a in s)l.append(a,s[a]);F(l)};async function F(s){u("loading",!0);try{const l=await Q("post","",s);l.data.status==="success"?(_.fire({title:"記帳成功!",icon:l.data.status}),P(o,"收入")):console.log(l),console.log("response")}catch(l){_.fire({title:"失敗!",text:l.message,icon:"error"}),console.error(l)}u("loading",!1)}return q(()=>o.Amount,s=>{s=s.replaceAll(",",""),o.Amount=X(s),j.value=Y(s)}),(s,l)=>{const a=B("font-awesome-icon");return r(),c("div",Z,[t("div",ee,[t("div",te,[t("div",se,[d(n(G),{modelValue:n(o).Date,"onUpdate:modelValue":l[0]||(l[0]=e=>n(o).Date=e),"enable-time-picker":!1,locale:"zh-tw","six-weeks":"center",required:"","text-input":"","auto-apply":"",dark:"","week-start":"0"},null,8,["modelValue"])]),t("div",oe,[t("button",{class:"rounded-md bg-teal-600 px-3 sm:px-5 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[1]||(l[1]=e=>R())},"重整")])]),t("div",null,[t("label",le,[d(a,{icon:["fas","chart-pie"]}),b(" 類別")]),t("div",ne,[t("ul",ae,[(r(!0),c(h,null,x(v,e=>(r(),c("li",{key:e,class:A({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(o).Cg===e,"dark:text-white":n(o).Cg!==e}),onClick:i=>n(o).Cg=e},k(e),11,re))),128))])])]),t("div",null,[t("label",ce,[d(a,{icon:["fas","align-left"]}),b(" 明細")]),w(t("input",{type:"text",id:"Detail","onUpdate:modelValue":l[2]||(l[2]=e=>n(o).Detail=e),class:"shadow-sm rounded-md border dark:border-none px-1 py-1 w-full text-left bg-slate-100 dark:text-white dark:bg-neutral-700"},null,512),[[M,n(o).Detail]])]),t("div",null,[t("label",ie,[d(a,{icon:["fas","dollar-sign"]}),b(" 金額")]),w(t("input",{type:"text",id:"Amount","onUpdate:modelValue":l[3]||(l[3]=e=>n(o).Amount=e),class:"px-1 py-1 w-full text-left outline-none font-bold bg-slate-100 dark:text-white dark:bg-neutral-700 shadow-sm rounded-md"},null,512),[[M,n(o).Amount]]),n(j)?(r(),c("h5",de,"* 只能輸入數字")):z("",!0)]),ue,t("div",me,[t("label",fe,[d(a,{icon:["fas","wallet"]}),b(" 帳戶")]),t("div",be,[t("ul",pe,[(r(!0),c(h,null,x(m,e=>(r(),c("li",{key:e,class:A({"px-1 py-1":!0,"bg-white":n(o).Account===e}),onMouseover:i=>L(e)},k(Object.keys(e)[0]),43,ge))),128))]),t("ul",he,[(r(!0),c(h,null,x(n(D),e=>(r(),c("li",{key:e,class:A({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(o).Acc===e,"dark:text-white":n(o).Acc!==e}),onClick:i=>$(e)},k(e),11,xe))),128))])])]),t("div",ke,[t("label",_e,[d(a,{icon:["fas","money-bill-transfer"]}),b(" 經手")]),t("div",ve,[t("ul",ye,[(r(!0),c(h,null,x(O,e=>(r(),c("li",{key:e,class:A({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(o).Incomement===e,"dark:text-white":n(o).Incomement!==e}),onClick:i=>n(o).Incomement=e},k(e),11,we))),128))])])]),t("div",Ae,[t("label",Ie,[d(a,{icon:["fas","pen-to-square"]}),b(" 備註")]),t("div",Oe,[(r(!0),c(h,null,x(C,(e,i)=>(r(),c("div",{key:e,class:"px-1 py-1 text-left"},[w(t("input",{type:"checkbox",id:"IncomeOthers"+i,"onUpdate:modelValue":l[4]||(l[4]=y=>n(o).Other=y),value:e},null,8,Ce),[[H,n(o).Other]]),t("label",{class:"dark:text-white cursor-pointer",for:"IncomeOthers"+i},k(e),9,De)]))),128)),t("div",Se,[Me,je,w(t("input",{type:"text",class:"dark:text-white bg-transparent","onUpdate:modelValue":l[5]||(l[5]=e=>W(f)?f.value=e:f=e)},null,512),[[M,n(f)]])])])])]),t("div",Ve,[t("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600 sm:mr-5",onClick:l[6]||(l[6]=e=>U(n(o)))},"送出"),t("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 fous-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[7]||(l[7]=e=>n(P)(n(o),"收入"))},"清除")])])}}};export{Le as default};
