import{r as _,a as C,o as q,w as z,b as W,c as r,d as c,e as o,f as d,u as n,g as f,F as g,h as p,i as M,v as $,j as G,W as H,n as h,t as k}from"./index-3aa2d797.js";import{s as J,f as N,S as v,u as K,a as Q,C as L,N as X,A as Y}from"./dataValidation-29207d58.js";const Z={id:"TransPage",class:"py-3 sm:px-12 sm:py-7 container border border-none"},ee={class:"grid grid-cols-1 gap-x-12 gap-y-6 sm:grid-cols-2"},te={class:"grid grid-cols-4 sm:grid-cols-5 gap-3 mx-auto sm:mt-9 w-full"},se={class:"col-span-3 sm:col-span-3"},oe={class:"col-span-1 sm:col-span-none"},le={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},ne={class:"shadow-sm rounded-md border dark:border-none w-full"},ae={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},re=["onClick"],ce={for:"Detail",class:"font-semibold mb-2 text-left block dark:text-white"},ie={for:"Amount",class:"font-semibold mb-2 text-left block dark:text-white"},de={key:0,class:"text-right text-red-300"},ue=o("div",{class:"sm:col-span-2"},[o("hr")],-1),me={class:""},be={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},fe={class:"shadow-sm rounded-md border dark:border-none w-full"},ge={class:"grid grid-cols-2 sm:grid-cols-4 SelTransOutAcc bg-teal-400"},pe=["onMouseover"],he={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},ke=["onClick"],xe={class:"TransIn"},_e={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},ve={class:"shadow-sm rounded-md border dark:border-none w-full"},we={class:"grid grid-cols-2 sm:grid-cols-4 SelTransInAcc bg-teal-400"},ye=["onMouseover"],Ae={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},Oe=["onClick"],Te={class:""},Ce={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},Ie={class:"shadow-sm rounded-md border dark:border-none w-full"},De={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},Se=["onClick"],je={class:"mt-10 mx-auto grid grid-cols-2 gap-3 sm:block"},Le={__name:"TransferPage",setup(Me,{emit:u}){const y=t=>{w.push(...t[0].TransCategories),m.push(...t[1].PayAccounts),b.push(...t[1].PayAccounts),A.push(...t[2].PayMents),O.value=Object.values(m[0])[0],T.value=Object.values(b[0])[0],s.OutAccount=Object.keys(m[0])[0],s.InAccount=Object.keys(b[0])[0],s.Cg=w[0]};(async()=>{try{u("loading",!0),J("Trans")||await N("get","Trans",y)}catch(t){v.fire({title:"ERROR",text:t.message,icon:"error"}),console.error(t)}u("loading",!1)})();const w=_([]),m=_([]),b=_([]),A=_([]);let O=C(""),T=C(""),I=C(!1),s=_({Type:"轉帳",OutAccount:"",OutAcc:"",InAccount:"",InAcc:"",Cg:"",Date:new Date,Amount:"",Detail:"",Transment:""});q(async()=>{await K("Trans",y)});const P=async()=>{try{u("loading",!0),[w,m,b,A].forEach(t=>t.splice(0,t.length)),localStorage.removeItem("Trans"),await N("get","Trans",y)}catch(t){v.fire({title:"ERROR",text:t.message,icon:"error"}),console.error(t)}u("loading",!1)},R=t=>{O.value=Object.values(t)[0],s.OutAccount=Object.keys(t)[0]},V=t=>{T.value=Object.values(t)[0],s.InAccount=Object.keys(t)[0]},E=t=>{D(m,s.OutAccount,".SelTransOutAcc"),s.OutAcc=t},F=t=>{D(b,s.InAccount,".SelTransInAcc"),s.InAcc=t},D=(t,l,a)=>{const e=t.find(x=>x[l]),i=Object.keys(e)[0],S=Array.from(document.querySelectorAll(a+" li"));S.forEach(x=>x.classList.remove("bg-teal-100"));const j=S.find(x=>x.innerText.includes(i));j.classList.remove("bg-teal-400"),j.classList.add("bg-teal-100")},B=t=>{for(const a of Object.keys(s))if((a==="Cg"||a==="Amount")&&!s[a]&&t.Trans!==""){v.fire({title:"資料未輸入完整!",icon:"warning"});return}const l=new FormData;for(const a in t)l.append(a,t[a]);U(l)};async function U(t){u("loading",!0);try{const l=await Q("post","",t);l.data.status==="success"?(v.fire({title:"記帳成功!",icon:l.data.status}),L(s,"轉帳")):console.log(l),console.log("response",l)}catch(l){v.fire({title:"失敗!",text:l.message,icon:"error"}),console.error(l)}u("loading",!1)}return z(()=>s.Amount,t=>{t=t.replaceAll(",",""),s.Amount=X(t),I.value=Y(t)}),(t,l)=>{const a=W("font-awesome-icon");return r(),c("div",Z,[o("div",ee,[o("div",te,[o("div",se,[d(n(H),{modelValue:n(s).Date,"onUpdate:modelValue":l[0]||(l[0]=e=>n(s).Date=e),"enable-time-picker":!1,locale:"zh-tw","six-weeks":"center",required:"","text-input":"","auto-apply":"",dark:"","week-start":"0"},null,8,["modelValue"])]),o("div",oe,[o("button",{class:"rounded-md bg-teal-600 px-3 sm:px-5 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[1]||(l[1]=e=>P())},"重整")])]),o("div",null,[o("label",le,[d(a,{icon:["fas","chart-pie"]}),f(" 類別")]),o("div",ne,[o("ul",ae,[(r(!0),c(g,null,p(w,e=>(r(),c("li",{key:e,class:h({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(s).Cg===e,"dark:text-white":n(s).Cg!==e}),onClick:i=>n(s).Cg=e},k(e),11,re))),128))])])]),o("div",null,[o("label",ce,[d(a,{icon:["fas","align-left"]}),f(" 明細")]),M(o("input",{type:"text",id:"Detail","onUpdate:modelValue":l[2]||(l[2]=e=>n(s).Detail=e),class:"shadow-sm rounded-md border dark:border-none px-1 py-1 w-full text-left bg-slate-100 dark:text-white dark:bg-neutral-700"},null,512),[[$,n(s).Detail]])]),o("div",null,[o("label",ie,[d(a,{icon:["fas","dollar-sign"]}),f(" 金額")]),M(o("input",{type:"text",id:"Amount","onUpdate:modelValue":l[3]||(l[3]=e=>n(s).Amount=e),class:"px-1 py-1 w-full text-left outline-none font-bold bg-slate-100 dark:text-white dark:bg-neutral-700 shadow-sm rounded-md"},null,512),[[$,n(s).Amount]]),n(I)?(r(),c("h5",de,"* 只能輸入數字")):G("",!0)]),ue,o("div",me,[o("label",be,[d(a,{icon:["fas","arrow-trend-up"]}),f(" 轉出帳戶")]),o("div",fe,[o("ul",ge,[(r(!0),c(g,null,p(m,e=>(r(),c("li",{key:e,class:h({"px-1 py-1":!0,"bg-white":n(s).OutAccount===e}),onMouseover:i=>R(e)},k(Object.keys(e)[0]),43,pe))),128))]),o("ul",he,[(r(!0),c(g,null,p(n(O),e=>(r(),c("li",{key:e,class:h({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(s).OutAcc===e,"dark:text-white":n(s).OutAcc!==e}),onClick:i=>E(e)},k(e),11,ke))),128))])])]),o("div",xe,[o("label",_e,[d(a,{icon:["fas","arrow-trend-down"]}),f(" 轉入帳戶")]),o("div",ve,[o("ul",we,[(r(!0),c(g,null,p(b,e=>(r(),c("li",{key:e,class:h({"px-1 py-1":!0,"bg-white":n(s).InAccount===e}),onMouseover:i=>V(e)},k(Object.keys(e)[0]),43,ye))),128))]),o("ul",Ae,[(r(!0),c(g,null,p(n(T),e=>(r(),c("li",{key:e,class:h({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":n(s).InAcc===e,"dark:text-white":n(s).InAcc!==e}),onClick:i=>F(e)},k(e),11,Oe))),128))])])]),o("div",Te,[o("label",Ce,[d(a,{icon:["fas","money-bill-transfer"]}),f(" 經手")]),o("div",Ie,[o("ul",De,[(r(!0),c(g,null,p(A,e=>(r(),c("li",{key:e,class:h({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":n(s).Transment===e,"dark:text-white":n(s).Transment!==e}),onClick:i=>n(s).Transment=e},k(e),11,Se))),128))])])])]),o("div",je,[o("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600 sm:mr-5",onClick:l[4]||(l[4]=e=>B(n(s)))},"送出"),o("button",{class:"rounded-md bg-teal-600 px-3 sm:px-12 py-2.5 text-center text-sm font-semibold text-white shadow-sm hover:bg-teal-500 fous-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:l[5]||(l[5]=e=>n(L)(n(s),"轉帳"))},"清除")])])}}};export{Le as default};
