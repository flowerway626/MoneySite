import{r as x,a as w,o as q,w as z,b as W,c as r,d as i,e as t,f as d,u as l,g as f,F as g,h as p,i as P,v as D,j as G,k as H,W as J,n as v,t as h,l as K}from"./index-3924c5e7.js";import{s as Q,f as $,S as M,u as X,P as Y,C as L,N as Z,A as ee}from"./dataValidation-6d1db4c4.js";const te={id:"PayPage",class:"py-3 sm:px-12 sm:py-7 container border border-none"},se={class:"grid grid-cols-1 gap-x-12 gap-y-6 sm:grid-cols-2"},oe={class:"grid grid-cols-4 sm:grid-cols-5 gap-3 mx-auto sm:mt-9 w-full"},le={class:"col-span-3 sm:col-span-3"},ae={class:"col-span-1 sm:col-span-none"},ne={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},re={class:"shadow-sm rounded-md border dark:border-none w-full"},ie={class:"grid grid-cols-4 sm:grid-cols-8 SelPayCg bg-teal-400"},ce=["onMouseover"],de={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelCg"},ue=["onClick"],me={for:"Detail",class:"font-semibold mb-2 text-left block dark:text-white"},be={for:"Amount",class:"font-semibold mb-2 text-left block dark:text-white"},fe={key:0,class:"text-right text-red-300"},ge=t("div",{class:"sm:col-span-2"},[t("hr")],-1),pe={class:""},he={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},ye={class:"shadow-sm rounded-md border dark:border-none w-full"},ke={class:"grid grid-cols-2 sm:grid-cols-4 SelPayAcc bg-teal-400"},xe=["onMouseover"],ve={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-b-md SelAcc"},_e=["onClick"],we={class:""},Pe={for:"Message",class:"font-semibold mb-2 text-left block dark:text-white"},Oe={class:"shadow-sm rounded-md border dark:border-none w-full"},Ae={class:"grid grid-cols-2 sm:grid-cols-3 bg-slate-100 dark:bg-neutral-700 rounded-md"},Ce=["onClick"],Se={class:"sm:col-span-2"},je={for:"Other",class:"font-semibold mb-2 text-left block dark:text-white"},De={class:"grid grid-cols-2 sm:grid-cols-6 bg-slate-100 dark:bg-neutral-700 shadow-sm rounded-md"},Me=["id","value"],Ve=["for"],Ne={class:"flex w-full col-span-2 px-1 py-1"},Re=t("input",{type:"checkbox",name:"其他",id:"其他"},null,-1),$e=t("label",{class:"dark:text-white",for:"其他"},"其他",-1),Le={class:"mt-10 mx-auto grid grid-cols-2 gap-3 sm:block"},Fe={__name:"PayPage",setup(Ee,{emit:y}){const O=s=>{u.push(...s[0].PayCategories),m.push(...s[1].PayAccounts),A.push(...s[2].PayMents),C.push(...s[3].PayOthers),S.value=Object.values(u[0])[0],j.value=Object.values(m[0])[0],o.Account=Object.keys(m[0])[0],o.Category=Object.keys(u[0])[0]};(async()=>{try{y("loading",!0),Q("Pay")||await $("get","Pay",O)}catch(s){M.fire({title:"ERROR",text:s.message,icon:"error"}),console.error(s)}y("loading",!1)})();const u=x([]),m=x([]),A=x([]),C=x([]);let S=w(""),j=w(""),b=w(""),V=w(!1),o=x({Type:"支出",Account:"",Acc:"",Category:"",Cg:"",Date:new Date,Amount:"",Detail:"",Payment:"",Other:[]});q(()=>{X("Pay",O)});const E=async()=>{try{y("loading",!0),[u,m,A,C].forEach(s=>s.splice(0,s.length)),localStorage.removeItem("Pay"),await $("get","Pay",O)}catch(s){M.fire({title:"ERROR",text:s.message,icon:"error"}),console.error(s)}y("loading",!1)},U=s=>{S.value=Object.values(s)[0],o.Category=Object.keys(s)[0]},B=s=>{j.value=Object.values(s)[0],o.Account=Object.keys(s)[0]},F=s=>{N(u,o.Category,".SelPayCg"),o.Cg=s},I=s=>{N(m,o.Account,".SelPayAcc"),o.Acc=s},N=(s,a,n)=>{const e=s.find(k=>k[a]),c=Object.keys(e)[0],_=Array.from(document.querySelectorAll(n+" li"));_.forEach(k=>k.classList.remove("bg-teal-100"));const R=_.find(k=>k.innerText.includes(c));R.classList.remove("bg-teal-400"),R.classList.add("bg-teal-100")},T=s=>{b.value.length!==0&&o.Other.push(b.value),s.Other=s.Other?s.Other.join(", "):"";for(const n of Object.keys(o))if(n!=="Payment"&&n!=="Other"&&!o[n]&&s.Pay!==""){M.fire({title:"資料未輸入完整!",icon:"warning",showConfirmButton:!1});return}const a=new FormData;for(const n in s)a.append(n,s[n]);Y(a,y,"支出",o,L)};return z(()=>o.Amount,s=>{s=s.replaceAll(",",""),o.Amount=Z(s),V.value=ee(s)}),(s,a)=>{const n=W("font-awesome-icon");return r(),i("div",te,[t("div",se,[t("div",oe,[t("div",le,[d(l(J),{modelValue:l(o).Date,"onUpdate:modelValue":a[0]||(a[0]=e=>l(o).Date=e),"enable-time-picker":!1,locale:"zh-tw","six-weeks":"center",required:"","text-input":"","auto-apply":"",dark:"","week-start":"0"},null,8,["modelValue"])]),t("div",ae,[t("button",{class:"rounded-md bg-teal-400 px-3 sm:px-5 py-2.5 text-center text-sm shadow-sm hover:bg-teal-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-600",onClick:a[1]||(a[1]=e=>E())},"重整")])]),t("div",null,[t("label",ne,[d(n,{icon:["fas","chart-pie"]}),f(" 類別")]),t("div",re,[t("ul",ie,[(r(!0),i(g,null,p(u,e=>(r(),i("li",{key:e,class:v({"px-1 py-1":!0,"bg-white":l(o).Category===e}),onMouseover:c=>U(e)},h(Object.keys(e)[0]),43,ce))),128))]),t("ul",de,[(r(!0),i(g,null,p(l(S),e=>(r(),i("li",{key:e,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":l(o).Cg===e,"dark:text-white":l(o).Cg!==e}),onClick:c=>F(e)},h(e),11,ue))),128))])])]),t("div",null,[t("label",me,[d(n,{icon:["fas","align-left"]}),f(" 明細")]),P(t("input",{type:"text",id:"Detail","onUpdate:modelValue":a[2]||(a[2]=e=>l(o).Detail=e),class:"shadow-sm rounded-md border dark:border-none px-1 py-1 w-full text-left bg-slate-100 dark:text-white dark:bg-neutral-700"},null,512),[[D,l(o).Detail]])]),t("div",null,[t("label",be,[d(n,{icon:["fas","dollar-sign"]}),f(" 金額")]),P(t("input",{type:"text",id:"Amount","onUpdate:modelValue":a[3]||(a[3]=e=>l(o).Amount=e),class:"px-1 py-1 w-full text-left outline-none font-bold bg-slate-100 dark:text-white dark:bg-neutral-700 shadow-sm rounded-md"},null,512),[[D,l(o).Amount]]),l(V)?(r(),i("h5",fe,"* 只能輸入數字")):G("",!0)]),ge,t("div",pe,[t("label",he,[d(n,{icon:["fas","wallet"]}),f(" 帳戶")]),t("div",ye,[t("ul",ke,[(r(!0),i(g,null,p(m,e=>(r(),i("li",{key:e,class:v({"px-1 py-1":!0,"bg-white":l(o).Account===e}),onMouseover:c=>B(e)},h(Object.keys(e)[0]),43,xe))),128))]),t("ul",ve,[(r(!0),i(g,null,p(l(j),e=>(r(),i("li",{key:e,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-block":l(o).Acc===e,"dark:text-white":l(o).Acc!==e}),onClick:c=>I(e)},h(e),11,_e))),128))])])]),t("div",we,[t("label",Pe,[d(n,{icon:["fas","money-bill-transfer"]}),f(" 經手")]),t("div",Oe,[t("ul",Ae,[(r(!0),i(g,null,p(A,e=>(r(),i("li",{key:e,class:v({"text-left px-1 py-1 cursor-pointer":!0,"bg-teal-100 dark:text-blcok":l(o).Payment===e,"dark:text-white":l(o).Payment!==e}),onClick:c=>l(o).Payment=e},h(e),11,Ce))),128))])])]),t("div",Se,[t("label",je,[d(n,{icon:["fas","pen-to-square"]}),f(" 備註")]),t("div",De,[(r(!0),i(g,null,p(C,(e,c)=>(r(),i("div",{key:e,class:"px-1 py-1 text-left"},[P(t("input",{type:"checkbox",id:"PayOthers"+c,"onUpdate:modelValue":a[4]||(a[4]=_=>l(o).Other=_),value:e},null,8,Me),[[K,l(o).Other]]),t("label",{class:"dark:text-white cursor-pointer",for:"PayOthers"+c},h(e),9,Ve)]))),128)),t("div",Ne,[Re,$e,P(t("input",{type:"text",class:"dark:text-white bg-transparent","onUpdate:modelValue":a[5]||(a[5]=e=>H(b)?b.value=e:b=e)},null,512),[[D,l(b)]])])])])]),t("div",Le,[t("button",{class:"rounded-md bg-teal-400 px-3 sm:px-12 py-2.5 text-center text-sm shadow-sm hover:bg-teal-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-400 sm:mr-5",onClick:a[6]||(a[6]=e=>T(l(o)))},"送出"),t("button",{class:"rounded-md bg-teal-400 px-3 sm:px-12 py-2.5 text-center text-sm shadow-sm hover:bg-teal-400 fous-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-teal-400",onClick:a[7]||(a[7]=e=>l(L)(l(o),"支出"))},"清除")])])}}};export{Fe as default};
